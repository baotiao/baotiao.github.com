<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>How InnoDB avoid "read-on-write" problem? &#8211; baotiao</title>
    <link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com">
    <link rel="dns-prefetch" href="//cdn.mathjax.org">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="How InnoDB avoid &quot;read-on-write&quot; problem">
    <meta name="robots" content="all">
    <meta name="author" content="baotiao">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://localhost:4000/2019/04/01/avoid-copy-on-write/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for baotiao" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?202204240501" type="text/css">

    <!-- Fonts -->
    
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
    

    <!-- MathJax -->
    

    <!-- Verifications -->
    
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How InnoDB avoid &quot;read-on-write&quot; problem?">
    <meta property="og:description" content="做有积累的事情">
    <meta property="og:url" content="http://localhost:4000/2019/04/01/avoid-copy-on-write/">
    <meta property="og:site_name" content="baotiao">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@baotiao" />
    
    <meta name="twitter:title" content="How InnoDB avoid "read-on-write" problem?" />
    <meta name="twitter:description" content="How InnoDB avoid "read-on-write" problem" />
    <meta name="twitter:url" content="http://localhost:4000/2019/04/01/avoid-copy-on-write/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">

    
</head>

<body class="site">
  
	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://localhost:4000" class="site-title">baotiao</a>
      <nav class="site-nav">
        
    

    
        <a href="/about/">About</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


    

    

    

    

    
        <a href="/links/">Links</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


    

    

    

    

    

    
        <a href="/paper/">Paper</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


      </nav>
      <div class="clearfix"></div>
      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>How InnoDB avoid "read-on-write" problem?</h1>
  <span class="post-meta">Apr 1 2019</span><br>
  
  <span class="post-meta small">
  
    4 minute read
  
  </span>
</div>

<article class="post-content">
  <h3 id="avoid-read-on-write">avoid read-on-write</h3>

<p>什么是 “read-on-write” problem?</p>

<p>在我们使用最常见的buffer write 中 “read-on-write” 问题指的是当我需要进行小于4k
大小buffer write 的时候, 需要先将数据所在的page 从disk 中读取出放入到page cache,
在page cache 中修改好, 然后再将这4k 数据写入回去. 这样在buffer write
的时候就多了一次磁盘IO</p>

<p>InnoDB 的做法是, 判断这个4k page 是不是第一次写入, 如果是第一次写入的话, 那么我会将这次写入填0, 变成4k 大小的size, 然后进行写入, 这样就可以避免了一次 “read-on-write” 操作, 后续继续写入的时候, 就不需要进行4k 大小的io, 因为这个时候数据已经在page cache 中,  直接写入就可以的.</p>

<p>我原先的想法是在内存中保留这个4k 大小的buffer, 每次修改都修改4k 大小的buffer, 每次写入也都进行4k 大小的写入, 这样做法反而不过InnoDB 的做法来得好, 因为每次写入都变成4k, 从用户空间拷贝到page cache 也需要拷贝4k 大小的数据, 而InnoDB 的做法只需要拷贝数据大小的size 就可以, 做的更细</p>

<p>下面两个例子可以看出同样写1G 大小的文件. InnoDB 的做法比标准追加写入做法提高40%</p>

<p>t.cc</p>

<p>write time microsecond(us) 51668825</p>

<p>t2.cc</p>

<p>write time microsecond(us) 29358162</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// t.cc</span>
<span class="c1">// 标准的通过pwrite 的写入方法</span>
<span class="c1">// 如果将这里的pwrite 改成write, 我们获得的还是几乎一样的performance</span>
<span class="c1">// num = pwrite(fd, aligned_buf, dsize, off);</span>
<span class="c1">// 估计在pwrite 内部实现, 如果只有一个线程写入, 并且这个offset 并没有移动, 就不需要先进行seek, 再write 了</span>

<span class="cp">#include &lt;stdio.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;stdint.h&gt;
#include &lt;random&gt;
</span>
<span class="cp">#include &lt;linux/falloc.h&gt;
#include &lt;sys/syscall.h&gt;
</span>
<span class="kt">uint64_t</span> <span class="nf">NowMicros</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">struct</span> <span class="n">timeval</span> <span class="n">tv</span><span class="p">;</span>
  <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">static_cast</span><span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tv</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000000</span> <span class="o">+</span> <span class="n">tv</span><span class="p">.</span><span class="n">tv_usec</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">uint64_t</span> <span class="n">st</span><span class="p">,</span> <span class="n">ed</span><span class="p">;</span>
  <span class="kt">uint64_t</span> <span class="n">file_size</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="mi">1024LL</span> <span class="o">*</span> <span class="mi">1024LL</span> <span class="o">*</span> <span class="mi">1024LL</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"/disk11/tf"</span><span class="p">,</span> <span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">O_RDWR</span><span class="p">,</span> <span class="mo">0666</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">aligned_buf</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">dsize</span> <span class="o">=</span> <span class="mi">512</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="n">posix_memalign</span><span class="p">((</span><span class="kt">void</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">aligned_buf</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">4096</span> <span class="o">*</span> <span class="mi">10</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">aligned_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">128</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">lseek</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SEEK_SET</span><span class="p">);</span>
  <span class="n">st</span> <span class="o">=</span> <span class="n">NowMicros</span><span class="p">();</span>
  <span class="kt">int</span> <span class="n">num</span><span class="p">;</span>
  <span class="kt">off_t</span> <span class="n">off</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">uint64_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">file_size</span> <span class="o">/</span> <span class="n">dsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">pwrite</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">aligned_buf</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">off</span><span class="p">);</span>
    <span class="n">off</span> <span class="o">+=</span> <span class="mi">512</span><span class="p">;</span>
    <span class="n">fsync</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">num</span> <span class="o">!=</span> <span class="n">dsize</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"write error num %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">num</span><span class="p">);</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">ed</span> <span class="o">=</span> <span class="n">NowMicros</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"write time microsecond(us) %lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ed</span> <span class="o">-</span> <span class="n">st</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>iostat 上, 可以看到nvme8n1有明显的磁盘read IO 存在</p>

<p><img src="https://i.imgur.com/FTpsY4H.jpg" alt="Imgur" /></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// t2.cc</span>
<span class="c1">// InnoDB 优化做法, 在遇到第一个4k 对齐地址的时候, 将当前这一次IO 对齐成4k, 空闲的部分filling zero. 从而避免了这一次需要将该page 从文件中读取到Page cache</span>
<span class="cp">#include &lt;stdio.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;stdint.h&gt;
#include &lt;random&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
</span>
<span class="cp">#include &lt;linux/falloc.h&gt;
#include &lt;sys/syscall.h&gt;
</span>
<span class="kt">uint64_t</span> <span class="nf">NowMicros</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">struct</span> <span class="n">timeval</span> <span class="n">tv</span><span class="p">;</span>
  <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">static_cast</span><span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tv</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000000</span> <span class="o">+</span> <span class="n">tv</span><span class="p">.</span><span class="n">tv_usec</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">uint64_t</span> <span class="n">st</span><span class="p">,</span> <span class="n">ed</span><span class="p">;</span>
  <span class="kt">uint64_t</span> <span class="n">file_size</span> <span class="o">=</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="mi">1024LL</span> <span class="o">*</span> <span class="mi">1024LL</span> <span class="o">*</span> <span class="mi">1024LL</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"/disk11/tf"</span><span class="p">,</span> <span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">O_RDWR</span><span class="p">,</span> <span class="mo">0666</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">aligned_buf</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">dsize</span> <span class="o">=</span> <span class="mi">512</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="n">posix_memalign</span><span class="p">((</span><span class="kt">void</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">aligned_buf</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">4096</span> <span class="o">*</span> <span class="mi">10</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">aligned_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">random</span><span class="p">()</span> <span class="o">%</span> <span class="mi">128</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">lseek</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SEEK_SET</span><span class="p">);</span>
  <span class="n">st</span> <span class="o">=</span> <span class="n">NowMicros</span><span class="p">();</span>
  <span class="kt">int</span> <span class="n">num</span><span class="p">;</span>
  <span class="kt">off_t</span> <span class="n">off</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">uint64_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">file_size</span> <span class="o">/</span> <span class="n">dsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">memset</span><span class="p">(</span><span class="n">aligned_buf</span> <span class="o">+</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
      <span class="n">num</span> <span class="o">=</span> <span class="n">pwrite</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">aligned_buf</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="n">off</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">num</span> <span class="o">=</span> <span class="n">pwrite</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">aligned_buf</span><span class="p">,</span> <span class="n">dsize</span><span class="p">,</span> <span class="n">off</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">off</span> <span class="o">+=</span> <span class="mi">512</span><span class="p">;</span>
    <span class="n">fsync</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">num</span> <span class="o">!=</span> <span class="n">dsize</span> <span class="o">&amp;&amp;</span> <span class="n">num</span> <span class="o">!=</span> <span class="mi">4096</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"write error num %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">num</span><span class="p">);</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">ed</span> <span class="o">=</span> <span class="n">NowMicros</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"write time microsecond(us) %lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ed</span> <span class="o">-</span> <span class="n">st</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>iostat 可以看到这个时刻nvme8n1是没有磁盘的read IO 存在的</p>

<p><img src="https://i.imgur.com/hsrB0oT.jpg" alt="Imgur" /></p>

<p>通过 blktrace 可以看到每一个IO的过程, 可以看详细的看到在t2 中是有read IO 的存在, 并且可以看到
在t 中read IO : write IO = 1:8</p>

<p>这是通过blktrace 看到的 t2 的IO</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>259,9    2      357     0.001166883     0  C  WS 75242264 + 8 <span class="o">[</span>0]
<span class="c">## 一个IO 的开始</span>
259,6    2      358     0.001173249 113640  A  WS 75242264 + 8 &lt;- <span class="o">(</span>259,9<span class="o">)</span> 75240216
259,9    2      359     0.001173558 113640  Q  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      360     0.001173664 113640  G  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      361     0.001173939 113640  U   N <span class="o">[</span>a.out] 1
259,9    2      362     0.001174017 113640  I  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      363     0.001174249 113640  D  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      364     0.001180838     0  C  WS 75242264 + 8 <span class="o">[</span>0]
<span class="c">## 一个IO 的结束</span>
259,6    2      365     0.001187163 113640  A  WS 75242264 + 8 &lt;- <span class="o">(</span>259,9<span class="o">)</span> 75240216
259,9    2      366     0.001187367 113640  Q  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      367     0.001187477 113640  G  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      368     0.001187755 113640  U   N <span class="o">[</span>a.out] 1
259,9    2      369     0.001187835 113640  I  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      370     0.001188072 113640  D  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      371     0.001194495     0  C  WS 75242264 + 8 <span class="o">[</span>0]
259,6    2      372     0.001200968 113640  A  WS 75242264 + 8 &lt;- <span class="o">(</span>259,9<span class="o">)</span> 75240216
259,9    2      373     0.001201164 113640  Q  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      374     0.001201268 113640  G  WS 75242264 + 8 <span class="o">[</span>a.out]
259,9    2      375     0.001201540 113640  U   N <span class="o">[</span>a.out] 1
</code></pre></div></div>

<p>从上面可以看出, 这个IO 从开始到结束都不会有Read 相关的IO</p>

<p>对比于t 产生的IO 是这样的</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 一个IO 的开始, 从这里可以看到这里有读IO 的出现, 并且其实这里是每产生1个读IO, 后续跟着8个 write IO</span>

259,6    0      184     0.001777196 58995  A   R 55314456 + 8 &lt;- <span class="o">(</span>259,9<span class="o">)</span> 55312408
259,9    0      185     0.001777463 58995  Q   R 55314456 + 8 <span class="o">[</span>a.out]
259,9    0      186     0.001777594 58995  G   R 55314456 + 8 <span class="o">[</span>a.out]
259,9    0      187     0.001777863 58995  D  RS 55314456 + 8 <span class="o">[</span>a.out]
259,9    0      188     0.002418822     0  C  RS 55314456 + 8 <span class="o">[</span>0]
<span class="c"># 一个读IO 结束</span>
259,6    0      189     0.002423915 58995  A  WS 55314456 + 8 &lt;- <span class="o">(</span>259,9<span class="o">)</span> 55312408
259,9    0      190     0.002424192 58995  Q  WS 55314456 + 8 <span class="o">[</span>a.out]
259,9    0      191     0.002424434 58995  G  WS 55314456 + 8 <span class="o">[</span>a.out]
259,9    0      192     0.002424816 58995  U   N <span class="o">[</span>a.out] 1
259,9    0      193     0.002424992 58995  I  WS 55314456 + 8 <span class="o">[</span>a.out]
259,9    0      194     0.002425247 58995  D  WS 55314456 + 8 <span class="o">[</span>a.out]
259,9    0      195     0.002432434     0  C  WS 55314456 + 8 <span class="o">[</span>0]
</code></pre></div></div>


</article>






  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'baotiao';
    var disqus_identifier = '/2019/04/01/avoid-copy-on-write';
    var disqus_title      = 'How InnoDB avoid "read-on-write" problem?';

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






      </div>
    </div>
  </div>

  <footer class="center">
</footer>


</body>
</html>
