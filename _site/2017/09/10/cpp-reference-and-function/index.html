<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>cpp reference and function &#8211; baotiao</title>
    <link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com">
    <link rel="dns-prefetch" href="//cdn.mathjax.org">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="cpp reference and function">
    <meta name="robots" content="all">
    <meta name="author" content="baotiao">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://localhost:4000/2017/09/10/cpp-reference-and-function/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for baotiao" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?202204110307" type="text/css">

    <!-- Fonts -->
    
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
    

    <!-- MathJax -->
    

    <!-- Verifications -->
    
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="cpp reference and function">
    <meta property="og:description" content="做有积累的事情">
    <meta property="og:url" content="http://localhost:4000/2017/09/10/cpp-reference-and-function/">
    <meta property="og:site_name" content="baotiao">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="@baotiao" />
    
    <meta name="twitter:title" content="cpp reference and function" />
    <meta name="twitter:description" content="cpp reference and function" />
    <meta name="twitter:url" content="http://localhost:4000/2017/09/10/cpp-reference-and-function/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">

    
</head>

<body class="site">
  
	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://localhost:4000" class="site-title">baotiao</a>
      <nav class="site-nav">
        
    

    
        <a href="/about/">About</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


    

    

    

    

    
        <a href="/links/">Links</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


    

    

    

    

    

    
        <a href="/paper/">Paper</a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


      </nav>
      <div class="clearfix"></div>
      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>cpp reference and function</h1>
  <span class="post-meta">Sep 10 2017</span><br>
  
  <span class="post-meta small">
  
    2 minute read
  
  </span>
</div>

<article class="post-content">
  <p>在cpp 里面</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
<span class="kt">int</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>这里 *, &amp; 和实际使用到 *p, &amp;a 的时候是不一个意思的, 在定义变量类型的时候 *, &amp; 是没有任何意义的, 表示的只是这个一个指针类型, 和引用类型</strong></p>

<p>**函数前面的 *, &amp; 和变量声明的 *, &amp; 一个意思, 只是表示这个函数返回值的类型. **</p>

<p><strong>函数的return val; 这里这个val 无论是 *val, &amp;val 都不影响这个函数的声明, 这个是函数的使用者不需要关注的, 也可以理解, 因此这个return val 属于函数的实现里面, 不属于函数的声明</strong></p>

<p>在这里我们要知道 &amp;(reference) 是cpp 新加入的一种类似, 和指针一样表示的是引用类型而同时&amp; 也是用来做取地址操作, 因此容易混淆.</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span> <span class="o">&amp;</span><span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="c1">// 这里&amp; 是声明r 是一个引用类型</span>
<span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span> <span class="c1">// 这里&amp; 是取地址操作</span>
</code></pre></div></div>

<h5 id="传给函数的时候什么时候用--什么时候用--呢">传给函数的时候什么时候用 &amp;, 什么时候用 * 呢?</h5>

<ol>
  <li>如果这个参数可以是NULL, 那么只能必须用 pointer, 否则就可以用&amp;</li>
  <li>为了方便起见传入的参数用&amp;, 可能被修改的用*</li>
</ol>

<p><strong>reference 一旦订下来 就不能修改, 比如 int &amp;b = a; 接下来就不能把这个b 又成为别人的引用, 因为引用的意思就是别名(an alternate name), 不能说b 既是a的别名, 也是c 的别名</strong></p>

<p>所以从这个角度来说 &amp; 和 int* const p 是一样的(注意和const int *p 的区别, const int *p 表示的是这个int 是const, 所以是不能对这个这个int 进行修改, 但是p 可以指向其他地址. 而int * const p 是p 是一个const 指针, 指向一个非const 的int. 可以对这个 *p = new value的, 但是不能让 p = new address, 因为就和引用一样, 是不能又成为一个新的值的引用的.)</p>

<h4 id="常见的函数和reference-几个问题">常见的函数和reference 几个问题</h4>

<ol>
  <li>
    <p>函数的定义前面加上 &amp;</p>
  </li>
  <li>
    <p>函数的定义前面加上 *</p>

    <ul>
      <li>
        <p>上面两个其实结果是一样的, 函数前面的 &amp;, * 其实有点类似于变量的声明时候的&amp;, * 的用途, 表示的都是没用任何意义. 只是声明这个函数的返回值是 reference 类型和指针类型. 在函数的返回 return val, 如果变成 return *val, return &amp;val 都是没有任何影响的, 就好像外部对这个val 一无所知, 只有函数前面的 int &amp;, int, int * 来描述这个return val 是什么意思一样. 所以 <strong>重要</strong> <strong>重要</strong> 函数前面的 *, &amp; 和变量声明的 *, &amp; 一个意思, 只是函数返回值的类型. 所以其实函数可以看成</p>

        <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span><span class="o">*</span> <span class="nf">fun</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">....</span> <span class="c1">// 中间这里是不用关注的</span>
  <span class="k">return</span> <span class="n">val</span><span class="p">;</span> <span class="c1">// 这里变成return *val, return &amp;val 都没有任何的影响</span>
<span class="p">}</span>
<span class="err">这就类似于</span> <span class="kt">int</span> <span class="o">*</span><span class="n">val</span><span class="p">;</span>
     
<span class="err">那么要接这个</span><span class="n">val</span> <span class="err">就必须是</span>
<span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">fun</span><span class="p">();</span> <span class="c1">// 因为这里 fun() 就是一个val. 而val 就是 int *类型.</span>
<span class="c1">// 或者这里函数的定义 int *fun() 就告诉了这里是int * 类型的意思</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>函数的返回结果如果是&amp; 的时候,  接这个函数的返回结果的变量必须定义成reference 类型. 就跟如果函数返回前面 *, 接这个函数的返回结果的变量必须定义成pointer 类型一样.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>函数的返回结果是const(其实把函数的声明看成变量的声明就清晰了)</p>

    <ol>
      <li>
        <p>一般函数的返回是引用或者指针的时候才有必要加上const, 表示的是对这个返回结果的一个保护, 不能修改这个返回结果. 如果直接返回的是值则没有任何意义, 因为返回的是值的时候返回的都是一个拷贝, 因此是可以随意修改的. 其实返回的是值可以看成这种</p>

        <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">const</span> <span class="kt">int</span> <span class="n">cb</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cb</span><span class="p">;</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
      
<span class="c1">// 因为函数的声明可以看出变量的声明, 因此上下两个是等价的, 下面这样也是没问题的</span>
<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="nf">fun</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fun</span><span class="p">();</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</code></pre></div>        </div>

        <p>​</p>
      </li>
      <li>
        <p>这个结论对在类里面的函数和对类外面的函数都试用</p>

        <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;stdio.h&gt;
</span>      
<span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
 <span class="nl">public:</span>
  <span class="kt">void</span> <span class="n">set_rel</span><span class="p">(</span><span class="kt">int</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">rel_</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
  <span class="p">}</span>
      
  <span class="cm">/*
   * 这里 relAddr1 和 relAddr 都是类似返回地址
   *
   * 这里 relAddr1 是c 里面的做法, 返回的是一个指针
   * 这个指针指向的是rel_ 的地址
   * 那么使用的时候就是
   * int *p = a-&gt;relAddr1();
   * *p = 30;
   * 那么这个时候a 里面的 rel_ 就会被修改
   *
   * relAddr 是c++ 里面的做法, 返回的是一个引用. 同样对返回的引用进行修改以后
   * 类里面的值也同样是有问题的
   *
   * 记住如果函数的返回类型是引用, 那么这个变量也必须是引用类型,
   * 才可以接到这个函数的引用
   * int &amp;b = a-&gt;relAddr();
   * b = 30;
   * 那么这个时候a 里面的 rel_ 也同样被修改
   *
   */</span>
      
      
  <span class="cm">/*
   * 这里如果写成
   * const int *relAddr1() {
   *
   * 那么下面就不能用 int *p 对这个赋值
   * int *p = a-&gt;relAddr1(); // 也就是const 指针赋值给一个非const 指针的错误
   */</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">relAddr1</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&amp;</span><span class="n">rel_</span><span class="p">;</span>
  <span class="p">};</span>
      
  <span class="cm">/*
   * const int &amp;relAddr() {
   * 这里如果给这个返回值加上const 以后, 那么下面的
   * int &amp;b = a-&gt;relAddr();
   * b = 30; // 这里就是报错, 因为const 的意思是说这个返回值是无法修改的
   * 所以如果确实需要返回一个reference 的话, 也最好是返回一个const reference
   */</span>
  <span class="kt">int</span> <span class="o">&amp;</span><span class="n">relAddr</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">rel_</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">const</span> <span class="kt">int</span> <span class="n">rel</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">rel_</span><span class="p">;</span>
  <span class="p">}</span>
      
  <span class="kt">int</span> <span class="n">rel_</span><span class="p">;</span>
<span class="p">};</span>
      
<span class="cm">/*
 * 这里const 对类外面的函数也同样适用, 所以如果需要返回的结果是&amp; 或者* 的时候,
 * 最好对这个变量进行const 修饰, 表示不能给被修改
 */</span>
<span class="kt">int</span> <span class="n">ax</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">fun</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">ax</span><span class="p">;</span>
<span class="p">}</span>
      
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">A</span> <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="p">();</span>
      
  <span class="n">a</span><span class="o">-&gt;</span><span class="n">set_rel</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">rel</span><span class="p">());</span>
      
  <span class="cm">/*
   * 这里如果定义 const int &amp;b, 那么接下来 b = 30 的时候就由于这个reference
   * 类型是const 所以不能赋值
   */</span>
  <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">relAddr</span><span class="p">();</span>
  <span class="n">b</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"%d %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">rel</span><span class="p">());</span>
      
  <span class="cm">/*
   * 同样这里如果定义的是 const int *p, 那么接下来就不能操作*p = 40. 
   * 因为这个指针是const 类型的
   */</span>
  <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">relAddr1</span><span class="p">();</span>
      
  <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"%d %d %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">rel</span><span class="p">(),</span> <span class="n">b</span><span class="p">);</span>
      
  <span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">xx</span> <span class="o">=</span> <span class="n">fun</span><span class="p">();</span>
  <span class="c1">// xx = 50;</span>
      
  <span class="n">printf</span><span class="p">(</span><span class="s">"%d %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">ax</span><span class="p">);</span>
        
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
</ol>


</article>






  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'baotiao';
    var disqus_identifier = '/2017/09/10/cpp-reference-and-function';
    var disqus_title      = 'cpp reference and function';

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






      </div>
    </div>
  </div>

  <footer class="center">
</footer>


</body>
</html>
